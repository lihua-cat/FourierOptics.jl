"S(λ) in range: 380:5:780"
const CIE_D_IILUMINANT_S =
    [63.40 38.50 3.00;
    64.60 36.75 2.10;
    65.80 35.00 1.20;
    80.30 39.20 0.05;
    94.80 43.40 -1.10;
    99.80 44.85 -0.80;
    104.80 46.30 -0.50;
    105.35 45.10 -0.60;
    105.90 43.90 -0.70;
    101.35 40.50 -0.95;
    96.80 37.10 -1.20;
    105.35 36.90 -1.90;
    113.90 36.70 -2.60;
    119.75 36.30 -2.75;
    125.60 35.90 -2.90;
    125.55 34.25 -2.85;
    125.50 32.60 -2.80;
    123.40 30.25 -2.70;
    121.30 27.90 -2.60;
    121.30 26.10 -2.60;
    121.30 24.30 -2.60;
    117.40 22.20 -2.20;
    113.50 20.10 -1.80;
    113.30 18.15 -1.65;
    113.10 16.20 -1.50;
    111.95 14.70 -1.40;
    110.80 13.20 -1.30;
    108.65 10.90 -1.25;
    106.50 8.60 -1.20;
    107.65 7.35 -1.10;
    108.80 6.10 -1.00;
    107.05 5.15 -0.75;
    105.30 4.20 -0.50;
    104.85 3.05 -0.40;
    104.40 1.90 -0.30;
    102.20 0.95 -0.15;
    100.00 0.00 0.00;
    98.00 -0.80 0.10;
    96.00 -1.60 0.20;
    95.55 -2.55 0.35;
    95.10 -3.50 0.50;
    92.10 -3.50 1.30;
    89.10 -3.50 2.10;
    89.80 -4.65 2.65;
    90.50 -5.80 3.20;
    90.40 -6.50 3.65;
    90.30 -7.20 4.10;
    89.35 -7.90 4.40;
    88.40 -8.60 4.70;
    86.20 -9.05 4.90;
    84.00 -9.50 5.10;
    84.55 -10.20 5.90;
    85.10 -10.90 6.70;
    83.50 -10.80 7.00;
    81.90 -10.70 7.30;
    82.25 -11.35 7.95;
    82.60 -12.00 8.60;
    83.75 -13.00 9.20;
    84.90 -14.00 9.80;
    83.10 -13.80 10.00;
    81.30 -13.60 10.20;
    76.60 -12.80 9.25;
    71.90 -12.00 8.30;
    73.10 -12.65 8.95;
    74.30 -13.30 9.60;
    75.35 -13.10 9.05;
    76.40 -12.90 8.50;
    69.85 -11.75 7.75;
    63.30 -10.60 7.00;
    67.50 -11.10 7.30;
    71.70 -11.60 7.60;
    74.35 -11.90 7.80;
    77.00 -12.20 8.00;
    71.10 -11.20 7.35;
    65.20 -10.20 6.70;
    56.45 -9.00 5.95;
    47.70 -7.80 5.20;
    58.15 -9.50 6.30;
    68.60 -11.20 7.40;
    66.80 -10.80 7.10;
    65.00 -10.40 6.80]

"Relative spectral power distribution of CIE Standard Illuminant D65(λ: 380:5:780)"
const CIE_D65_IILUMINANT = 
    [49.975500
    52.311800
    54.648200
    68.701500
    82.754900
    87.120400
    91.486000
    92.458900
    93.431800
    90.057000
    86.682300
    95.773600
    104.865000
    110.936000
    117.008000
    117.410000
    117.812000
    116.336000
    114.861000
    115.392000
    115.923000
    112.367000
    108.811000
    109.082000
    109.354000
    108.578000
    107.802000
    106.296000
    104.790000
    106.239000
    107.689000
    106.047000
    104.405000
    104.225000
    104.046000
    102.023000
    100.000000
    98.167100
    96.334200
    96.061100
    95.788000
    92.236800
    88.685600
    89.345900
    90.006200
    89.802600
    89.599100
    88.648900
    87.698700
    85.493600
    83.288600
    83.493900
    83.699200
    81.863000
    80.026800
    80.120700
    80.214600
    81.246200
    82.277800
    80.281000
    78.284200
    74.002700
    69.721300
    70.665200
    71.609100
    72.979000
    74.349000
    67.976500
    61.604000
    65.744800
    69.885600
    72.486300
    75.087000
    69.339800
    63.592700
    55.005400
    46.418200
    56.611800
    66.805400
    65.094100
    63.382800]

"The relative spectral power distribution of CIE Standard Illuminant series D(4000K <= T <= 25000K)"
function illuminantD(T, λ=380:5:780, S=CIE_D_IILUMINANT_S)
    if 4000 <= T <= 7000
        x = 0.244063 + 0.09911 * 10^3 / T + 2.9678 * 10^6 / T^2 - 4.6070 * 10^9 / T^3
    elseif 7000 < T <= 25000
        x = 0.237040 + 0.24748 * 10^3 / T + 1.9018 * 10^6 / T^2 - 2.0064 * 10^9 / T^3
    end
    y = -3 * x^2 + 2.87 * x - 0.275
    m = 0.0241 + 0.2562 * x - 0.7341 * y
    m1 = (-1.3515 - 1.7703 * x + 5.9114 * y) / m
    m2 = (0.03 - 31.4424 * x + 30.0717y) / m
    S0 = S[:, 1]
    S1 = S[:, 2]
    S2 = S[:, 3]
    S = S0 + m1 * S1 + m2 * S2
    c = sum(S .* colormatch.(λ))
    S = S / xyY(c).Y
    (;λ, S)
end

"The relative spectral power distribution of CIE standard illuminant D65"
function illuminantD65(λ=380:5:780, S_D=CIE_D65_IILUMINANT)
    c = sum(S_D .* colormatch.(λ))
    S = S_D ./ xyY(c).Y
    (;λ, S)
end